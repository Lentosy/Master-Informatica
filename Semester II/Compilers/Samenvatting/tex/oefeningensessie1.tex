\chapter{Oefeningensessie 1}

\section{Oefening 3.6 p85}
Gegeven de volgende grammatica:
\begin{equation*}
	\begin{split}
	& S \mapsto uBDz \\
	& B \mapsto Bv \\
	& B \mapsto w \\
	& D \mapsto EF \\
	& E \mapsto y \\
	& E \mapsto \\
	& F \mapsto x \\
	& F \mapsto 
	\end{split}
\end{equation*}
\begin{enumerate}
	\item \textbf{Bereken nullable, FIRST en FOLLOW.}
	\begin{table}[h]
		\centering
		\begin{tabular}{| l | c | c | c |}
			\hline
			& nullable & FIRST & FOLLOW \\
			\hline
			S & nee & \{ u \}    & /	 			\\
			B & nee & \{ w \}    & \{ x, y, v, z \}	\\
			D & ja  & \{ x, y \} & \{ z \}			\\
			E & ja  & \{ y \}    & \{ x, z \}		\\
			F & ja  & \{ x \}    & \{ z \}			\\
			\hline
		\end{tabular}
	\end{table}

	\item \textbf{Construeer de $LL(1)$ parsingtabel.}
	\begin{table}[h]
		\centering
		\begin{tabular}{| l | l | l | l | l | l | l |}
			\hline
			   & u 					& z & v & w & y & x \\
			 S & $S \mapsto uBDz$  	&   &   &   &   &   \\
			 B &   					&   &   & $B \mapsto w, \; B \mapsto Bv$  &   &   \\
			 D &  					& $D \mapsto EF$  &   &   & $D \mapsto EF$  & $D \mapsto EF$   \\
			 E &   					& $E \mapsto $  &   &   & $E \mapsto y$  &  $E \mapsto $ \\
			 F &   					& $F \mapsto $  &   &   &   &  $F \mapsto x$ \\
			\hline
		\end{tabular}
	\end{table}

	\item \textbf{Toon aan dat dit geen $LL(1)$ parser is.}
	
	Als we B aan het parsen zijn, en het eerstvolgende token is een $w$ dan weten we niet welke productieregel toegepast moet worden.
	
	\item \textbf{Wijzig de grammatica \emph{zo weinig mogelijk} om een $LL(1)$ grammatica te hebben dat dezelfde taal aanvaardt.}
	
	Door de linkse recursiviteit van de productieregel $B \mapsto Bv$, kunnen volgende veranderingen ingevoerd worden:
	\begin{equation*}
		\begin{split}
		& B \mapsto wB' \\
		& B' \mapsto vB' \\
		& B' \mapsto 
		\end{split}
	\end{equation*}
\end{enumerate}

\section{Voorbeeldexamenvraag}
Gegeven de reguliere expressie $S = ab+c$.
\begin{enumerate}
	\item \textbf{Schrijf een (ambigue) grammatica voor $S$ met tokens $a$, $b$ en $c$.}
	
	\begin{equation*}
		\begin{split}
	1.\; & S' \mapsto S \& \\
	2.\; & S \mapsto aBc \\
	3.\; & B \mapsto bB \\
	4.\;& B \mapsto b 
		\end{split}
	\end{equation*}
	
	\item \textbf{Geef de $LR(0)$ statentabel en $LR(0)$ parsingtabel.}
	
	Altijd de closure nemen van productieregel van niet-terminal waar het puntje voor staat. dus alle productieregels opnemen in toestand van die niet-terminal. Uiteindelijk moet elk puntje op het einde staan.
	
	\begin{figure}[ht]
		\centering
		\begin{tikzpicture}[state/.style={rectangle, draw, inner sep = 2mm}]
		\node (1) [state] {$\begin{aligned}S' \mapsto& .S\$ \\ S \mapsto& .aBc\end{aligned}$};
		\node (2) [state, right = 1.5cm of 1] {$S \mapsto S.\$$};
		\node (3) [state, below = 1cm of 1] {$\begin{aligned}
			S \mapsto& a.Bc \\
			B \mapsto& .bB \\
			B \mapsto& .b
			\end{aligned}$};
		\node (4) [state, right = 1.5cm of 3] {$\begin{aligned}
			S \mapsto& aB.c
			\end{aligned}$};
		\node (7) [state, right = 1.5cm of 4] {$\begin{aligned}
			S \mapsto& aBc.
			\end{aligned}$};
		\node (5) [state, below = 1cm of 3] {$\begin{aligned}
			B \mapsto& b.B \\
			B \mapsto& b. \\
			B \mapsto& .bB \\
			B \mapsto& .b
			\end{aligned}$};
		\node (6) [state, right = 1.5cm of 5] {$\begin{aligned}
			B \mapsto& bB. 
			\end{aligned}$};
		
		\draw [->] (1) -- node[yshift=0.25cm] {S} (2);
		\draw [->] (1) -- node[xshift=0.25cm] {a} (3);
		\draw [->] (3) -- node[yshift=0.25cm] {B} (4);
		\draw [->] (3) -- node[xshift=0.25cm] {b} (5);
		\draw [->] (4) -- node[yshift=0.25cm] {c} (7);
		\draw [->] (5) -- node[yshift=0.25cm] {B} (6);
		\path [->] (5) edge[loop left] node[yshift=0.25cm] {b} ();
		
		\node (label1) [anchor=north east, inner sep = 1pt] at (1.north east) {\textbf{1.}};
		\node (label1) [anchor=north east, inner sep = 1pt] at (2.north east) {\textbf{2.}};
		\node (label1) [anchor=north east, inner sep = 1pt] at (3.north east) {\textbf{3.}};
		\node (label1) [anchor=north east, inner sep = 1pt] at (4.north east) {\textbf{4.}};
		\node (label1) [anchor=north east, inner sep = 1pt] at (5.north east) {\textbf{5.}};
		\node (label1) [anchor=north east, inner sep = 1pt] at (6.north east) {\textbf{6.}};
		\node (label1) [anchor=north east, inner sep = 1pt] at (7.north east) {\textbf{7.}};
		\end{tikzpicture}
	\end{figure}

	
	\begin{table}[h]
		\centering
		\begin{tabular}{| l  | l | l | l | l | l | l |}
			\hline
			  & a & b & c & \$ & S & B \\
			  \hline
			1 & s3  &   &   &    & g2\footnote{Als er een reductie uitgevoerd is in toestand 1 voor $S$, dan moeten we naar toestand 2 gaan}   &   \\
			2 & & & & & & \\
			3 & & s5\footnote{Als we $b$ shiften uit toestand 3 zitten we in toestand 5} & & & & g4 \\
			4 & & & s7 & & & \\
			5 & r3\footnote{Reductie kan uitgevoerd worden met regel 3 ($B \mapsto b$)} & s5,r3 & r3 & r3 & & g6 \\
			6 & r2 & r2 & r2 & r2 & & \\
			7 & r1 & r1 & r1 & r1 & & \\
			\hline
		\end{tabular}
	\end{table}

	\item \textbf{Zijn er conflicten? Waarom wel of niet?}
	
	Er is een shift-reduce conflict voor toestand 5 en token $b$. Dit komt omdat de gekozen grammatica ambigue is.

	\item \textbf{Construeer een niet-ambigue LL parsingtabel die deze expressie herkent. Indien nodig, maak eerst de originele grammatica niet-ambigue.}
		
		Grammatica herschrijven:
	\begin{equation*}
	\begin{split}
	& S \mapsto aBc \\
	& B \mapsto bB' \\
	& B' \mapsto  \\
	& B' \mapsto B 
	\end{split}
	\end{equation*}
	
	nullable, FIRST en FOLLOW bepalen:
	\begin{table}[ht]
		\centering
		\begin{tabular}{| l | l | l | l |}
			\hline
			& nullable & FIRST & FOLLOW \\
			\hline
			S & nee  & \{ a \}    & /	 			\\
			B & nee  & \{ b \}    & \{ c \}	\\
			B' & ja  & \{ b \}    & \{ c \}			\\
			\hline
		\end{tabular}
	\end{table}

	$LL(1)$ parsing table opstellen:
	
	\begin{table}[h]
		\centering
		\begin{tabular}{| l | l | l | l |}
			\hline
			  & a 					& b & c \\
			  \hline
			S & $S \mapsto aBc$	    &   &   \\
			B &   					& $B \mapsto bB'$  &   \\
			B' &  & $B' \mapsto B$ & $B' \mapsto$ \\
			\hline
		\end{tabular}
	\end{table}
	
\end{enumerate}

\section{Oefening 3.13 p86}
Toon aan dat de volgende grammatica $LALR(1)$ is maar niet $SLR$:
\begin{equation*}
\begin{split}
0 :& S \mapsto X\& \\
1 :& X \mapsto Ma \\
2 :& X \mapsto bMc \\
3 :& X \mapsto dc \\
4 :& X \mapsto bda \\
5 :& M \mapsto d
\end{split}
\end{equation*}

Zowel een SLR als een LALR parser maken gebruik van een LR(0) statentabel, deze wordt eerst opgesteld.

	\begin{figure}[ht]
	\centering
	\begin{tikzpicture}[state/.style={rectangle, draw, inner sep = 2mm}]
	\node (1) [state] {
		$\begin{aligned}
			S \mapsto& .X\&   \\
			X \mapsto& .Ma  \\
			X \mapsto& .bMc \\
			X \mapsto& .dc  \\
			X \mapsto& .bda \\
			M \mapsto&  .d 
		\end{aligned}$};
	\node (2) [state, right = 1.5cm of 1] {$S \mapsto X.\&$};

	\node (4) [state, below = 1cm of 1] {
		$\begin{aligned}
			X \mapsto&b.Mc \\
			X \mapsto&b.da \\
			M \mapsto&.d
		\end{aligned}$};
	\node (3) [state, left = 1.5cm of 4] {
		$\begin{aligned}
			X \mapsto&M.a
		\end{aligned}$};
	\node (5) [state, right = 1.5cm of 4] {
		$\begin{aligned}
		X \mapsto&d.c \\
		M \mapsto&d.
		\end{aligned}$};
	\node (6) [state, below = 1cm of 3] {
		$\begin{aligned}
			X \mapsto&Ma.
		\end{aligned}$};
	\node (7) [state, below = 1.5cm of 4] {
		$\begin{aligned}
			X \mapsto&bM.c
		\end{aligned}$};
	\node (8) [state, right = 1cm of 7] {
		$\begin{aligned}
		X \mapsto&bd.a \\
		M \mapsto&d.
		\end{aligned}$};
	\node (9) [state, right = 1cm of 5] {
		$\begin{aligned}
		X\mapsto&dc.
		\end{aligned}$};
	\node (10) [state, below = 1.5cm of 7] {
		$\begin{aligned}
		X \mapsto&bMc.
		\end{aligned}$};
	\node (11) [state, below = 1.5cm of 8] {
		$\begin{aligned}
		X \mapsto&bda.
		\end{aligned}$};
	
	\draw [->] (1) -- node[yshift=0.25cm] {X} (2);
	\draw [->] (1) -- node[xshift=0.25cm] {d} (5);
	\draw [->] (1) -- node[xshift=0.25cm] {b} (4);
	\draw [->] (1) -- node[xshift=0.25cm] {M} (3);
	\draw [->] (3) -- node[xshift=0.25cm] {a} (6);
	\draw [->] (4) -- node[xshift=0.25cm] {M} (7);
	\draw [->] (4) -- node[xshift=0.25cm] {d} (8);
	\draw [->] (7) -- node[xshift=0.25cm] {c} (10);
	\draw [->] (5) -- node[yshift=0.25cm] {c} (9);
	\draw [->] (8) -- node[xshift=0.25cm] {a} (11);
	
	\node (label1) [anchor=north east, inner sep = 1pt] at (1.north east) {\textbf{1.}};
	\node (label2) [anchor=north east, inner sep = 1pt] at (2.north east) {\textbf{2.}};
	\node (label3) [anchor=north east, inner sep = 1pt] at (3.north east) {\textbf{3.}};
	\node (label4) [anchor=north east, inner sep = 1pt] at (4.north east) {\textbf{4.}};
	\node (label5) [anchor=north east, inner sep = 1pt] at (5.north east) {\textbf{5.}};
	\node (label6) [anchor=north east, inner sep = 1pt] at (6.north east) {\textbf{6.}};
	\node (label7) [anchor=north east, inner sep = 1pt] at (7.north east) {\textbf{7.}};
	\node (label8) [anchor=north east, inner sep = 1pt] at (8.north east) {\textbf{8.}};
	\node (label9) [anchor=north east, inner sep = 1pt] at (9.north east) {\textbf{9.}};
	\node (label10) [anchor=north east, inner sep = 1pt] at (10.north east) {\textbf{10.}};
	\node (label11) [anchor=north east, inner sep = 1pt] at (11.north east) {\textbf{11.}};
	\end{tikzpicture}
\end{figure}

Een grammatica is LALR(1) of SLR indien respectievelijk de LALR(1) en SLR parsetabellen geen shift-reduce conflicten bevat. Een SLR parsetabel wordt bijna identiek hetzelfde opgesteld als een LR(0) parsetabel. Het enige verschil is dat reduce acties enkel geplaatst worden bij de terminalen die in de FOLLOW set zitten. 

Een LALR(1) parsetabel wordt opgesteld door eerst de LR(1) parsetabel op te bouwen. Daarna worden staten samengevoegd die dezelfde productieregels bevat, maar waarbij de lookahead tokens eventueel verschillen. De reduce acties worden enkel toegepast op de terminalen die in de lookahead set zitten.